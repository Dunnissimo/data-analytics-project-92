"name","operations","income"
Dirk Stringer,4192,4925137932
Michel DeFrance,4688,3260240833
Albert Ringer,4695,2700327941
Heather McBadden,4139,1873192318
Innes del Castillo,4674,1762202127
Abraham Bennet,9460,1617501169
Dean Straight,4195,1256032202
Livia Karsen,2564,1056902108
Sheryl Hunter,4686,1056767862
Michael O'Leary,5757,927500459
0,"select 
	 e.first_name || ' ' || e.last_name as name, -- объединяем столбцы с именем и фамилией в одно целое из таблици employees
	 count(s.sales_id) as operations, -- считаем кол-во проведенных сделок за все время из таблицы sales
	 floor(sum(p.price * s.quantity)) as income -- перемножаем кол-во проданного товара на его цену, и суммируем, чтобы узнать общую выручку продавца за все время (и округляем в меньшую сторону)
from employees e
left join sales s -- объединяем таблицы employees и sales
	on e.employee_id = s.sales_person_id
left join products p -- объединяем таблицы sales и products
	on s.product_id = p.product_id
group by 1 -- группируем таблицу по имени продавца
order by 3 desc nulls last -- сортируем по убыванию выручки, перенося вероятные нулы в конец таблицы
limit 10; -- ограничиваем результат 10ю строками",Sat Nov 04 14:17:34 MSK 2023,
